{
  "version": 3,
  "sources": [
    "imagem.js"
  ],
  "names": [
    "module",
    "exports",
    "utils",
    "app",
    "modules",
    "storage",
    "diskStorage",
    "destination",
    "req",
    "file",
    "cb",
    "filename",
    "fieldname",
    "Date",
    "now",
    "upload",
    "single",
    "route",
    "all",
    "auth",
    "authenticate",
    "get",
    "res",
    "Imagens",
    "getModel",
    "params",
    "empresa",
    "findAll",
    "then",
    "json",
    "imagens",
    "catch",
    "status",
    "msg",
    "err",
    "message",
    "post",
    "create",
    "body",
    "value",
    "findOne",
    "where",
    "id",
    "sendStatus",
    "put",
    "update",
    "delete",
    "destroy"
  ],
  "mappings": "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",
  "file": "imagem.js",
  "sourceRoot": "../../../build/routes/routes",
  "sourcesContent": [
    "import multer from 'multer';\n\nmodule.exports = app => {\n\n    const utils = app.app.modules.utils;\n    \n    const storage = multer.diskStorage({\n      destination: function (req, file, cb) {\n        cb(null, '/srv/uploads');\n      },\n      filename: function (req, file, cb) {\n        cb(null, file.fieldname + '-' + Date.now());\n      }\n    });\n\n    const upload = multer({storage}).single('file');\n\n    app.route('/imagem/:empresa')\n    .all(app.auth.authenticate())\n\n    .get((req, res) => {\n      /**Contem o objeto de Tasks, que está na pasta models */\n      const Imagens = utils.getModel(req.params.empresa, 'imagem');\n\n      Imagens.findAll({})\n      .then(imagens => res.json({imagens}))\n      //Error 412 usado para quando uma dos atributos passados no cabeçalho for considerado com falso\n      //assim impedindo o recurso de ser executado\n      .catch(err => res.status(412).json({msg: err.message}));\n    })\n\n    .post((req, res) => {\n      const Imagens = utils.getModel(req.params.empresa, 'imagem');\n\n      Imagens.create(req.body)\n      .then(value => res.json(value))\n      //Error 412 usado para quando uma dos atributos passados no cabeçalho for considerado com falso\n      //assim impedindo o recurso de ser executado\n      .catch(err => res.status(412).json({msg: err.message}));\n    });\n\n    app.route('/imagem/:empresa/:id')\n    .all(app.auth.authenticate())\n\n    .get((req, res) => {\n      /**Contem o objeto de Tasks, que está na pasta models */\n      const Imagens = utils.getModel(req.params.empresa, 'imagem');\n\n      Imagens.findOne({ where: { id: req.params.id } })\n      .then(value => {\n        value = value === null ? {} : value;\n\n        if (value) return res.json(value);\n\n        //Caso não encontre valor, retorna 404 -> Registro não encontrado\n        return res.sendStatus(404);\n      })\n      //Error 412 usado para quando uma dos atributos passados no cabeçalho for considerado com falso\n      //assim impedindo o recurso de ser executado\n      .catch(err => res.status(412).json({msg: err.message}))\n    })\n\n    .put((req, res) => {\n      /**Contem o objeto de Tasks, que está na pasta models */\n      const Imagens = utils.getModel(req.params.empresa, 'imagem');\n\n      Imagens.update(req.body, {where: {id: req.params.id}})\n      //Retorna 204 Significa que foi executada com sucesso porém não retornou conteudo com resposta\n      .then(value => res.sendStatus(204))\n      //Error 412 usado para quando uma dos atributos passados no cabeçalho for considerado com falso\n      //assim impedindo o recurso de ser executado\n      .catch(err => res.status(412).json({msg: err.message}))\n    })\n\n    .delete((req, res) => {\n      /**Contem o objeto de Tasks, que está na pasta models */\n      const Imagens = utils.getModel(req.params.empresa, 'imagem');\n\n      Imagens.destroy({where: {id: req.params.id}})\n      .then(value => res.sendStatus(204))\n      //Error 412 usado para quando uma dos atributos passados no cabeçalho for considerado com falso\n      //assim impedindo o recurso de ser executado\n      .catch(err => res.status(412).json({msg: err.message}))\n    });\n\n    /**Roda especifica para upload de imagem */\n    app.route('/imagem/:empresa/upload/')\n    .all(app.auth.authenticate())\n    .post((req, res) => {\n      upload(req, res, function (err) {\n        if (err) {\n          // An error occurred when uploading\n          return res.status(412).json({msg: err.message});\n        }\n\n        return res.sendStatus(204);\n      })\n      \n    }); \n}\n"
  ]
}
