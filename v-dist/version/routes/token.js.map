{
  "version": 3,
  "sources": [
    "token.js"
  ],
  "names": [
    "module",
    "exports",
    "config",
    "app",
    "libs",
    "User",
    "sysDb",
    "models",
    "usuarios_aplos",
    "post",
    "req",
    "res",
    "body",
    "email",
    "senha",
    "findOne",
    "where",
    "then",
    "isPassword",
    "user",
    "payload",
    "id",
    "json",
    "token",
    "encode",
    "jwtSecret",
    "mn1",
    "mn2",
    "_idEmpresa",
    "image",
    "imagem",
    "tipo",
    "sendStatus",
    "catch"
  ],
  "mappings": ";;AAAA;;;;;;AAEAA,OAAOC,OAAP,GAAiB,eAAO;AACpB,QAAMC,SAASC,IAAIC,IAAJ,CAASF,MAAxB;AACA,QAAMG,OAAOF,IAAIC,IAAJ,CAASE,KAAT,CAAeC,MAAf,CAAsBC,cAAnC;;AAEAL,QAAIM,IAAJ,CAAS,QAAT,EAAmB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B,YAAID,IAAIE,IAAJ,CAASC,KAAT,IAAkBH,IAAIE,IAAJ,CAASE,KAA/B,EAAsC;AAClC,gBAAMD,QAAQH,IAAIE,IAAJ,CAASC,KAAvB;AACA,gBAAMC,QAAQJ,IAAIE,IAAJ,CAASE,KAAvB;;AAEAT,iBAAKU,OAAL,CAAa,EAACC,OAAQ,EAACH,YAAD,EAAT,EAAb,EACCI,IADD,CACM,gBAAQ;AACV,oBAAIZ,KAAKa,UAAL,CAAgBC,KAAKL,KAArB,EAA4BA,KAA5B,CAAJ,EAAwC;AACpC,wBAAMM,UAAU,EAACC,IAAIF,KAAKE,EAAV,EAAhB;;AAEA,2BAAOV,IAAIW,IAAJ,CAAS;AACZC,+BAAO,oBAAIC,MAAJ,CAAWJ,OAAX,EAAoBlB,OAAOuB,SAA3B,CADK;AAEZC,6BAAKP,KAAKE,EAFE;AAGZM,6BAAKR,KAAKS,UAHE;AAIZC,+BAAOV,KAAKW,MAJA;AAKZC,8BAAM;AALM,qBAAT,CAAP;AAOH;;AAED,uBAAOpB,IAAIqB,UAAJ,CAAe,GAAf,CAAP;AACH,aAfD,EAgBCC,KAhBD,CAgBO;AAAA,uBAAStB,IAAIqB,UAAJ,CAAe,GAAf,CAAT;AAAA,aAhBP;AAiBH,SArBD,MAqBO;AACH,mBAAOrB,IAAIqB,UAAJ,CAAe,GAAf,CAAP;AACH;AACJ,KAzBD;AA0BH,CA9BD",
  "file": "token.js",
  "sourceRoot": "../../build/routes",
  "sourcesContent": [
    "import jwt from 'jwt-simple';\n\nmodule.exports = app => {\n    const config = app.libs.config;\n    const User = app.libs.sysDb.models.usuarios_aplos;\n    \n    app.post('/token', (req, res) => {\n        if (req.body.email && req.body.senha) {\n            const email = req.body.email;\n            const senha = req.body.senha;\n\n            User.findOne({where : {email}})\n            .then(user => {\n                if (User.isPassword(user.senha, senha)) {\n                    const payload = {id: user.id};\n\n                    return res.json({\n                        token: jwt.encode(payload, config.jwtSecret),\n                        mn1: user.id,\n                        mn2: user._idEmpresa,\n                        image: user.imagem,\n                        tipo: '1'\n                    });\n                }\n\n                return res.sendStatus(401);\n            })\n            .catch(error => res.sendStatus(401));\n        } else {\n            return res.sendStatus(401);\n        }\n    });\n}"
  ]
}
