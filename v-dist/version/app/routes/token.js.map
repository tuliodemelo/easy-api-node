{
  "version": 3,
  "sources": [
    "token.js"
  ],
  "names": [
    "module",
    "exports",
    "config",
    "app",
    "libs",
    "User",
    "sysDb",
    "models",
    "usuarios_aplos",
    "post",
    "req",
    "res",
    "body",
    "email",
    "senha",
    "findOne",
    "where",
    "then",
    "isPassword",
    "user",
    "payload",
    "id",
    "json",
    "token",
    "encode",
    "jwtSecret",
    "sendStatus",
    "catch"
  ],
  "mappings": ";;AAAA;;;;;;AAEAA,OAAOC,OAAP,GAAiB,eAAO;AACpB,QAAMC,SAASC,IAAIC,IAAJ,CAASF,MAAxB;AACA,QAAMG,OAAOF,IAAIC,IAAJ,CAASE,KAAT,CAAeC,MAAf,CAAsBC,cAAnC;;AAEAL,QAAIM,IAAJ,CAAS,QAAT,EAAmB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B,YAAID,IAAIE,IAAJ,CAASC,KAAT,IAAkBH,IAAIE,IAAJ,CAASE,KAA/B,EAAsC;AAClC,gBAAMD,QAAQH,IAAIE,IAAJ,CAASC,KAAvB;AACA,gBAAMC,QAAQJ,IAAIE,IAAJ,CAASE,KAAvB;;AAEAT,iBAAKU,OAAL,CAAa,EAACC,OAAQ,EAACH,YAAD,EAAT,EAAb,EACCI,IADD,CACM,gBAAQ;AACV,oBAAIZ,KAAKa,UAAL,CAAgBC,KAAKL,KAArB,EAA4BA,KAA5B,CAAJ,EAAwC;AACpC,wBAAMM,UAAU,EAACC,IAAIF,KAAKE,EAAV,EAAhB;;AAEA,2BAAOV,IAAIW,IAAJ,CAAS;AACZC,+BAAO,oBAAIC,MAAJ,CAAWJ,OAAX,EAAoBlB,OAAOuB,SAA3B;AADK,qBAAT,CAAP;AAGH;;AAED,uBAAOd,IAAIe,UAAJ,CAAe,GAAf,CAAP;AACH,aAXD,EAYCC,KAZD,CAYO;AAAA,uBAAShB,IAAIe,UAAJ,CAAe,GAAf,CAAT;AAAA,aAZP;AAaH,SAjBD,MAiBO;AACH,mBAAOf,IAAIe,UAAJ,CAAe,GAAf,CAAP;AACH;AACJ,KArBD;AAsBH,CA1BD",
  "file": "token.js",
  "sourceRoot": "../../../build/app/routes",
  "sourcesContent": [
    "import jwt from 'jwt-simple';\n\nmodule.exports = app => {\n    const config = app.libs.config;\n    const User = app.libs.sysDb.models.usuarios_aplos;\n    \n    app.post('/token', (req, res) => {\n        if (req.body.email && req.body.senha) {\n            const email = req.body.email;\n            const senha = req.body.senha;\n\n            User.findOne({where : {email}})\n            .then(user => {\n                if (User.isPassword(user.senha, senha)) {\n                    const payload = {id: user.id};\n\n                    return res.json({\n                        token: jwt.encode(payload, config.jwtSecret),\n                    });\n                }\n\n                return res.sendStatus(401);\n            })\n            .catch(error => res.sendStatus(401));\n        } else {\n            return res.sendStatus(401);\n        }\n    });\n}"
  ]
}
